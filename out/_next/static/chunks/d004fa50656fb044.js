(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,965592,e=>{"use strict";let t,r,n,i;var o,f,s=e.i(923075),a=e.i(743429),l=e.i(769325);let u=BigInt(0),d=BigInt(1);function c(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function h(e,t,r=""){let n=(0,a.isBytes)(e),i=e?.length,o=void 0!==t;if(!n||o&&i!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(o?` of length ${t}`:"")+", got "+(n?`length=${i}`:`type=${typeof e}`));return e}function m(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function y(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?u:BigInt("0x"+e)}function g(e){return y((0,a.bytesToHex)(e))}function p(e){return(0,a.abytes)(e),y((0,a.bytesToHex)(Uint8Array.from(e).reverse()))}function b(e,t){return(0,a.hexToBytes)(e.toString(16).padStart(2*t,"0"))}function E(e,t){return b(e,t).reverse()}function w(e,t,r){let n;if("string"==typeof t)try{n=(0,a.hexToBytes)(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if((0,a.isBytes)(t))n=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let i=n.length;if("number"==typeof r&&i!==r)throw Error(e+" of length "+r+" expected, got "+i);return n}let B=e=>"bigint"==typeof e&&u<=e;function v(e,t,r){return B(e)&&B(t)&&B(r)&&t<=e&&e<r}function x(e){let t;for(t=0;e>u;e>>=d,t+=1);return t}let O=e=>(d<<BigInt(e))-d;function R(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function n(t,r,n){let i=e[t];if(n&&void 0===i)return;let o=typeof i;if(o!==r||null===i)throw Error(`param "${t}" is invalid: expected ${r}, got ${o}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))}function S(e){let t=new WeakMap;return(r,...n)=>{let i=t.get(r);if(void 0!==i)return i;let o=e(r,...n);return t.set(r,o),o}}let I=BigInt(0),A=BigInt(1),q=BigInt(2),T=BigInt(3),N=BigInt(4),U=BigInt(5),F=BigInt(7),Z=BigInt(8),V=BigInt(9),P=BigInt(16);function C(e,t){let r=e%t;return r>=I?r:t+r}function D(e,t,r){let n=e;for(;t-- >I;)n*=n,n%=r;return n}function K(e,t){if(e===I)throw Error("invert: expected non-zero number");if(t<=I)throw Error("invert: expected positive modulus, got "+t);let r=C(e,t),n=t,i=I,o=A,f=A,s=I;for(;r!==I;){let e=n/r,t=n%r,a=i-f*e,l=o-s*e;n=r,r=t,i=f,o=s,f=a,s=l}if(n!==A)throw Error("invert: does not exist");return C(i,t)}function j(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function _(e,t){let r=(e.ORDER+A)/N,n=e.pow(t,r);return j(e,n,t),n}function H(e,t){let r=(e.ORDER-U)/Z,n=e.mul(t,q),i=e.pow(n,r),o=e.mul(t,i),f=e.mul(e.mul(o,q),i),s=e.mul(o,e.sub(f,e.ONE));return j(e,s,t),s}function k(e){if(e<T)throw Error("sqrt is not defined for small field");let t=e-A,r=0;for(;t%q===I;)t/=q,r++;let n=q,i=G(e);for(;1===Y(i,n);)if(n++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return _;let o=i.pow(n,t),f=(t+A)/q;return function(e,n){if(e.is0(n))return n;if(1!==Y(e,n))throw Error("Cannot find square root");let i=r,s=e.mul(e.ONE,o),a=e.pow(n,t),l=e.pow(n,f);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw Error("Cannot find square root");let n=A<<BigInt(i-t-1),o=e.pow(s,n);i=t,s=e.sqr(o),a=e.mul(a,s),l=e.mul(l,o)}return l}}let L=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function $(e){return R(e,L.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),e}function M(e,t,r=!1){let n=Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),o=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),o),n}function Y(e,t){let r=(e.ORDER-A)/q,n=e.pow(t,r),i=e.eql(n,e.ONE),o=e.eql(n,e.ZERO),f=e.eql(n,e.neg(e.ONE));if(!i&&!o&&!f)throw Error("invalid Legendre symbol result");return i?1:o?0:-1}function z(e,t){void 0!==t&&(0,a.anumber)(t);let r=void 0!==t?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function G(e,t,r=!1,n={}){let i,o,f,s;if(e<=I)throw Error("invalid field: expected ORDER > 0, got "+e);let a=!1;if("object"==typeof t&&null!=t){if(n.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(o=t.BITS),t.sqrt&&(f=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(a=t.modFromBytes),s=t.allowedLengths}else"number"==typeof t&&(o=t),n.sqrt&&(f=n.sqrt);let{nBitLength:l,nByteLength:u}=z(e,o);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let d=Object.freeze({ORDER:e,isLE:r,BITS:l,BYTES:u,MASK:O(l),ZERO:I,ONE:A,allowedLengths:s,create:t=>C(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return I<=t&&t<e},is0:e=>e===I,isValidNot0:e=>!d.is0(e)&&d.isValid(e),isOdd:e=>(e&A)===A,neg:t=>C(-t,e),eql:(e,t)=>e===t,sqr:t=>C(t*t,e),add:(t,r)=>C(t+r,e),sub:(t,r)=>C(t-r,e),mul:(t,r)=>C(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<I)throw Error("invalid exponent, negatives unsupported");if(r===I)return e.ONE;if(r===A)return t;let n=e.ONE,i=t;for(;r>I;)r&A&&(n=e.mul(n,i)),i=e.sqr(i),r>>=A;return n})(d,e,t),div:(t,r)=>C(t*K(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>K(t,e),sqrt:f||(t=>(i||(i=function(e){if(e%N===T)return _;if(e%Z===U)return H;if(e%P===V){let t,r,n,i,o,f;return t=G(e),n=(r=k(e))(t,t.neg(t.ONE)),i=r(t,n),o=r(t,t.neg(n)),f=(e+F)/P,(e,t)=>{let r=e.pow(t,f),s=e.mul(r,n),a=e.mul(r,i),l=e.mul(r,o),u=e.eql(e.sqr(s),t),d=e.eql(e.sqr(a),t);r=e.cmov(r,s,u),s=e.cmov(l,a,d);let c=e.eql(e.sqr(s),t),h=e.cmov(r,s,c);return j(e,h,t),h}}return k(e)}(e)),i(d,t))),toBytes:e=>r?E(e,u):b(e,u),fromBytes:(t,n=!0)=>{if(s){if(!s.includes(t.length)||t.length>u)throw Error("Field.fromBytes: expected "+s+" bytes, got "+t.length);let e=new Uint8Array(u);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+t.length);let i=r?p(t):g(t);if(a&&(i=C(i,e)),!n&&!d.isValid(i))throw Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:e=>M(d,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(d)}function X(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function W(e){let t=X(e);return t+Math.ceil(t/2)}function J(e,t,r=!1){let n=e.length,i=X(t),o=W(t);if(n<16||n<o||n>1024)throw Error("expected "+o+"-1024 bytes of input, got "+n);let f=C(r?p(e):g(e),t-A)+A;return r?E(f,i):b(f,i)}let Q=BigInt(0),ee=BigInt(1);function et(e,t){let r=t.negate();return e?r:t}function er(e,t){let r=M(e.Fp,t.map(e=>e.Z));return t.map((t,n)=>e.fromAffine(t.toAffine(r[n])))}function en(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function ei(e,t){en(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),i=2**e;return{windows:r,windowSize:n,mask:O(e),maxNumber:i,shiftBy:BigInt(e)}}function eo(e,t,r){let{windowSize:n,mask:i,maxNumber:o,shiftBy:f}=r,s=Number(e&i),a=e>>f;s>n&&(s-=o,a+=ee);let l=t*n,u=l+Math.abs(s)-1,d=0===s;return{nextN:a,offset:u,isZero:d,isNeg:s<0,isNegF:t%2!=0,offsetF:l}}let ef=new WeakMap,es=new WeakMap;function ea(e){return es.get(e)||1}function el(e){if(e!==Q)throw Error("invalid wNAF")}class eu{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let n=e;for(;t>Q;)t&ee&&(r=r.add(n)),n=n.double(),t>>=ee;return r}precomputeWindow(e,t){let{windows:r,windowSize:n}=ei(t,this.bits),i=[],o=e,f=o;for(let e=0;e<r;e++){f=o,i.push(f);for(let e=1;e<n;e++)f=f.add(o),i.push(f);o=f.double()}return i}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let n=this.ZERO,i=this.BASE,o=ei(e,this.bits);for(let e=0;e<o.windows;e++){let{nextN:f,offset:s,isZero:a,isNeg:l,isNegF:u,offsetF:d}=eo(r,e,o);r=f,a?i=i.add(et(u,t[d])):n=n.add(et(l,t[s]))}return el(r),{p:n,f:i}}wNAFUnsafe(e,t,r,n=this.ZERO){let i=ei(e,this.bits);for(let e=0;e<i.windows&&r!==Q;e++){let{nextN:o,offset:f,isZero:s,isNeg:a}=eo(r,e,i);if(r=o,!s){let e=t[f];n=n.add(a?e.negate():e)}}return el(r),n}getPrecomputes(e,t,r){let n=ef.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),ef.set(t,n))),n}cached(e,t,r){let n=ea(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)}unsafe(e,t,r,n){let i=ea(e);return 1===i?this._unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)}createCache(e,t){en(t,this.bits),es.set(e,t),ef.delete(e)}hasCache(e){return 1!==ea(e)}}function ed(e,t,r){if(!t)return G(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return $(t),t}let ec=(e,t)=>(e+(e>=0?t:-t)/eb)/t;function eh(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function em(e,t){let r={};for(let n of Object.keys(t))r[n]=void 0===e[n]?t[n]:e[n];return c(r.lowS,"lowS"),c(r.prehash,"prehash"),void 0!==r.format&&eh(r.format),r}let ey={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=ey;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let n=t.length/2,i=m(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");let o=n>127?m(i.length/2|128):"";return m(e)+o+i+t},decode(e,t){let{Err:r}=ey,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let i=t[n++],o=0;if(128&i){let e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+e);if(f.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===f[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of f)o=o<<8|e;if(n+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;let f=t.subarray(n,n+o);if(f.length!==o)throw new r("tlv.decode: wrong value length");return{v:f,l:t.subarray(n+o)}}},_int:{encode(e){let{Err:t}=ey;if(e<eg)throw new t("integer: negative integers are not allowed");let r=m(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=ey;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return g(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=ey,i=w("signature",e),{v:o,l:f}=n.decode(48,i);if(f.length)throw new t("invalid signature: left bytes after parsing");let{v:s,l:a}=n.decode(2,o),{v:l,l:u}=n.decode(2,a);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(s),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=ey,n=t.encode(2,r.encode(e.r)),i=t.encode(2,r.encode(e.s));return t.encode(48,n+i)}},eg=BigInt(0),ep=BigInt(1),eb=BigInt(2),eE=BigInt(3),ew=BigInt(4);function eB(e,t){let r,{BYTES:n}=e;if("bigint"==typeof t)r=t;else{let i=w("private key",t);try{r=e.fromBytes(i)}catch(e){throw Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function ev(e){return Uint8Array.of(e?2:3)}function ex(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function eO(e,t){if(eR(e),eR(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=255&e,e>>>=8;return new Uint8Array(r)}function eR(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function eS(e){if(!(0,a.isBytes)(e)&&"string"!=typeof e)throw Error("DST must be Uint8Array or string");return"string"==typeof e?(0,a.utf8ToBytes)(e):e}function eI(e,t,r){var n;let i;R(r,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:o,k:f,m:s,hash:l,expand:u,DST:d}=r;if(!("function"==typeof(n=r.hash)&&Number.isSafeInteger(n.outputLen)))throw Error("expected valid hash");(0,a.abytes)(e),eR(t);let c=Math.ceil((o.toString(2).length+f)/8),h=t*s*c;if("xmd"===u)i=function(e,t,r,n){(0,a.abytes)(e),eR(r),(t=eS(t)).length>255&&(t=n((0,a.concatBytes)((0,a.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:o}=n,f=Math.ceil(r/i);if(r>65535||f>255)throw Error("expand_message_xmd: invalid lenInBytes");let s=(0,a.concatBytes)(t,eO(t.length,1)),l=eO(0,o),u=eO(r,2),d=Array(f),c=n((0,a.concatBytes)(l,e,u,eO(0,1),s));d[0]=n((0,a.concatBytes)(c,eO(1,1),s));for(let e=1;e<=f;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}(c,d[e-1]),eO(e+1,1),s];d[e]=n((0,a.concatBytes)(...t))}return(0,a.concatBytes)(...d).slice(0,r)}(e,d,h,l);else if("xof"===u)i=function(e,t,r,n,i){if((0,a.abytes)(e),eR(r),(t=eS(t)).length>255){let e=Math.ceil(2*n/8);t=i.create({dkLen:e}).update((0,a.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(eO(r,2)).update(t).update(eO(t.length,1)).digest()}(e,d,h,f,l);else if("_internal_pass"===u)i=e;else throw Error('expand must be "xmd" or "xof"');let m=Array(t);for(let e=0;e<t;e++){let t=Array(s);for(let r=0;r<s;r++){let n=c*(r+e*s),f=i.subarray(n,n+c);t[r]=C(g(f),o)}m[e]=t}return m}let eA=(0,a.utf8ToBytes)("HashToScalar-"),eq={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},eT={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},eN=BigInt(0),eU=BigInt(1),eF=BigInt(2),eZ=G(eq.p,{sqrt:function(e){let t=eq.p,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),f=BigInt(23),s=BigInt(44),a=BigInt(88),l=e*e*e%t,u=l*l*e%t,d=D(u,r,t)*u%t,c=D(d,r,t)*u%t,h=D(c,eF,t)*l%t,m=D(h,i,t)*h%t,y=D(m,o,t)*m%t,g=D(y,s,t)*y%t,p=D(g,a,t)*g%t,b=D(p,s,t)*y%t,E=D(b,r,t)*u%t,w=D(E,f,t)*m%t,B=D(w,n,t)*l%t,v=D(B,eF,t);if(!eZ.eql(eZ.sqr(v),e))throw Error("Cannot find square root");return v}}),eV=(o={...eq,Fp:eZ,lowS:!0,endo:eT},f=s.sha256,{...(t=e=>(function(e){let t,{CURVE:r,curveOpts:n,hash:i,ecdsaOpts:o}=function(e){let t,r,n,i,{CURVE:o,curveOpts:f}=(t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,i={Fp:r,Fn:G(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes},{CURVE:t,curveOpts:i}),s={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:o,curveOpts:f,hash:e.hash,ecdsaOpts:s}}(e),f=function(e,t,r={}){(0,a.ahash)(t),R(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let n=r.randomBytes||a.randomBytes,i=r.hmac||((e,...r)=>(0,l.hmac)(t,e,(0,a.concatBytes)(...r))),{Fp:o,Fn:f}=e,{ORDER:s,BITS:u}=f,{keygen:d,getPublicKey:c,getSharedSecret:m,utils:y,lengths:p}=function(e,t={}){let{Fn:r}=e,n=t.randomBytes||a.randomBytes,i=Object.assign(ex(e.Fp,r),{seed:W(r.ORDER)});function o(e){try{return!!eB(r,e)}catch(e){return!1}}function f(e=n(i.seed)){return J(h(e,i.seed,"seed"),r.ORDER)}function s(t,n=!0){return e.BASE.multiply(eB(r,t)).toBytes(n)}function l(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:n,publicKey:o,publicKeyUncompressed:f}=i;if(r.allowedLengths||n===o)return;let s=w("key",t).length;return s===o||s===f}return Object.freeze({getPublicKey:s,getSharedSecret:function(t,n,i=!0){if(!0===l(t))throw Error("first arg must be private key");if(!1===l(n))throw Error("second arg must be public key");let o=eB(r,t);return e.fromHex(n).multiply(o).toBytes(i)},keygen:function(e){let t=f(e);return{secretKey:t,publicKey:s(t)}},Point:e,utils:{isValidSecretKey:o,isValidPublicKey:function(t,r){let{publicKey:n,publicKeyUncompressed:o}=i;try{let i=t.length;if(!0===r&&i!==n||!1===r&&i!==o)return!1;return!!e.fromBytes(t)}catch(e){return!1}},randomSecretKey:f,isValidPrivateKey:o,randomPrivateKey:f,normPrivateKeyToScalar:e=>eB(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:i})}(e,r),b={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},E="compact";function B(e,t){if(!f.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class x{constructor(e,t,r){this.r=B("r",e),this.s=B("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=E){var r,n;let i,o;if(r=e,eh(n=t),o=p.signature,h(r,"compact"===n?o:"recovered"===n?o+1:void 0,`${n} signature`),"der"===t){let{r:t,s:r}=ey.toSig(h(e));return new x(t,r)}"recovered"===t&&(i=e[0],t="compact",e=e.subarray(1));let s=f.BYTES,a=e.subarray(0,s),l=e.subarray(s,2*s);return new x(f.fromBytes(a),f.fromBytes(l),i)}static fromHex(e,t){return this.fromBytes((0,a.hexToBytes)(e),t)}addRecoveryBit(e){return new x(this.r,this.s,e)}recoverPublicKey(t){let r=o.ORDER,{r:n,s:i,recovery:l}=this;if(null==l||![0,1,2,3].includes(l))throw Error("recovery id invalid");if(s*eb<r&&l>1)throw Error("recovery id is ambiguous for h>1 curve");let u=2===l||3===l?n+s:n;if(!o.isValid(u))throw Error("recovery id 2 or 3 invalid");let d=o.toBytes(u),c=e.fromBytes((0,a.concatBytes)(ev((1&l)==0),d)),h=f.inv(u),m=I(w("msgHash",t)),y=f.create(-m*h),g=f.create(i*h),p=e.BASE.multiplyUnsafe(y).add(c.multiplyUnsafe(g));if(p.is0())throw Error("point at infinify");return p.assertValidity(),p}hasHighS(){return this.s>s>>ep}toBytes(e=E){if(eh(e),"der"===e)return(0,a.hexToBytes)(ey.hexFromSig(this));let t=f.toBytes(this.r),r=f.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return(0,a.concatBytes)(Uint8Array.of(this.recovery),t,r)}return(0,a.concatBytes)(t,r)}toHex(e){return(0,a.bytesToHex)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return x.fromBytes(w("sig",e),"compact")}static fromDER(e){return x.fromBytes(w("sig",e),"der")}normalizeS(){return this.hasHighS()?new x(this.r,f.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,a.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,a.bytesToHex)(this.toBytes("compact"))}}let S=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=g(e),r=8*e.length-u;return r>0?t>>BigInt(r):t},I=r.bits2int_modN||function(e){return f.create(S(e))},A=O(u);function q(e){var t="num < 2^"+u;if(!v(e,eg,A))throw Error("expected valid "+t+": "+eg+" <= n < "+A+", got "+e);return f.toBytes(e)}function T(e,r){return h(e,void 0,"message"),r?h(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:d,getPublicKey:c,getSharedSecret:m,utils:y,lengths:p,Point:e,sign:function(r,o,l={}){let{seed:u,k2sig:d}=function(t,r,i){if(["recovered","canonical"].some(e=>e in i))throw Error("sign() legacy options not supported");let{lowS:o,prehash:l,extraEntropy:u}=em(i,b),d=I(t=T(t,l)),c=eB(f,r),h=[q(c),q(d)];if(null!=u&&!1!==u){let e=!0===u?n(p.secretKey):u;h.push(w("extraEntropy",e))}return{seed:(0,a.concatBytes)(...h),k2sig:function(t){let r=S(t);if(!f.isValidNot0(r))return;let n=f.inv(r),i=e.BASE.multiply(r).toAffine(),a=f.create(i.x);if(a===eg)return;let l=f.create(n*f.create(d+a*c));if(l===eg)return;let u=2*(i.x!==a)|Number(i.y&ep),h=l;return o&&l>s>>ep&&(h=f.neg(l),u^=1),new x(a,h,u)}}}(r=w("message",r),o,l);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=e=>new Uint8Array(e),i=n(e),o=n(e),f=0,s=()=>{i.fill(1),o.fill(0),f=0},l=(...e)=>r(o,i,...e),u=(e=n(0))=>{(o=l(Uint8Array.of(0),e),i=l(),0!==e.length)&&(o=l(Uint8Array.of(1),e),i=l())},d=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=l()).slice();r.push(t),e+=i.length}return(0,a.concatBytes)(...r)};return(e,t)=>{let r;for(s(),u(e);!(r=t(d()));)u();return s(),r}})(t.outputLen,f.BYTES,i)(u,d)},verify:function(t,r,n,i={}){let{lowS:o,prehash:s,format:l}=em(i,b);if(n=w("publicKey",n),r=T(w("message",r),s),"strict"in i)throw Error("options.strict was renamed to lowS");let u=void 0===l?function(e){let t,r="string"==typeof e||(0,a.isBytes)(e),n=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!n)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)t=new x(e.r,e.s);else if(r){try{t=x.fromBytes(w("sig",e),"der")}catch(e){if(!(e instanceof ey.Err))throw e}if(!t)try{t=x.fromBytes(w("sig",e),"compact")}catch(e){return!1}}return!!t&&t}(t):x.fromBytes(w("sig",t),l);if(!1===u)return!1;try{let t=e.fromBytes(n);if(o&&u.hasHighS())return!1;let{r:i,s}=u,a=I(r),l=f.inv(s),d=f.create(a*l),c=f.create(i*l),h=e.BASE.multiplyUnsafe(d).add(t.multiplyUnsafe(c));if(h.is0())return!1;return f.create(h.x)===i}catch(e){return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:n}=em(r,b);return t=T(t,n),x.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:x,hash:t})}(function(e,t={}){let r=function(e,t,r={},n){if(void 0===n&&(n="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>Q))throw Error(`CURVE.${e} must be positive bigint`)}let i=ed(t.p,r.Fp,n),o=ed(t.n,r.Fn,n);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!i.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:i,Fn:o}}("weierstrass",e,t),{Fp:n,Fn:i}=r,o=r.CURVE,{h:f,n:s}=o;R(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:l}=t;if(l&&(!n.is0(o.a)||"bigint"!=typeof l.beta||!Array.isArray(l.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let u=ex(n,i);function d(){if(!n.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let m=t.toBytes||function(e,t,r){let{x:i,y:o}=t.toAffine(),f=n.toBytes(i);if(c(r,"isCompressed"),!r)return(0,a.concatBytes)(Uint8Array.of(4),f,n.toBytes(o));{d();let e=!n.isOdd(o);return(0,a.concatBytes)(ev(e),f)}},y=t.fromBytes||function(e){h(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=u,i=e.length,o=e[0],f=e.subarray(1);if(i===t&&(2===o||3===o)){let e,t=n.fromBytes(f);if(!n.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=g(t);try{e=n.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return d(),(1&o)==1!==n.isOdd(e)&&(e=n.neg(e)),{x:t,y:e}}if(i===r&&4===o){let e=n.BYTES,t=n.fromBytes(f.subarray(0,e)),r=n.fromBytes(f.subarray(e,2*e));if(!p(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${i}, expected compressed=${t} or uncompressed=${r}`)};function g(e){let t=n.sqr(e),r=n.mul(t,e);return n.add(n.add(r,n.mul(e,o.a)),o.b)}function p(e,t){let r=n.sqr(t),i=g(e);return n.eql(r,i)}if(!p(o.Gx,o.Gy))throw Error("bad curve params: generator point");let b=n.mul(n.pow(o.a,eE),ew),E=n.mul(n.sqr(o.b),BigInt(27));if(n.is0(n.add(b,E)))throw Error("bad curve params: a or b");function B(e,t,r=!1){if(!n.isValid(t)||r&&n.is0(t))throw Error(`bad point coordinate ${e}`);return t}function v(e){if(!(e instanceof N))throw Error("ProjectivePoint expected")}function I(e){if(!l||!l.basises)throw Error("no endo");return function(e,t,r){let[[n,i],[o,f]]=t,s=ec(f*e,r),a=ec(-i*e,r),l=e-s*n-a*o,u=-s*i-a*f,d=l<eg,c=u<eg;d&&(l=-l),c&&(u=-u);let h=O(Math.ceil(x(r)/2))+ep;if(l<eg||l>=h||u<eg||u>=h)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:d,k1:l,k2neg:c,k2:u}}(e,l.basises,i.ORDER)}let A=S((e,t)=>{let{X:r,Y:i,Z:o}=e;if(n.eql(o,n.ONE))return{x:r,y:i};let f=e.is0();null==t&&(t=f?n.ONE:n.inv(o));let s=n.mul(r,t),a=n.mul(i,t),l=n.mul(o,t);if(f)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw Error("invZ was invalid");return{x:s,y:a}}),q=S(e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw Error("bad point: x or y not field elements");if(!p(r,i))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function T(e,t,r,i,o){return r=new N(n.mul(r.X,e),r.Y,r.Z),t=et(i,t),r=et(o,r),t.add(r)}class N{constructor(e,t,r){this.X=B("x",e),this.Y=B("y",t,!0),this.Z=B("z",r),Object.freeze(this)}static CURVE(){return o}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw Error("invalid affine point");if(e instanceof N)throw Error("projective point not allowed");return n.is0(t)&&n.is0(r)?N.ZERO:new N(t,r,n.ONE)}static fromBytes(e){let t=N.fromAffine(y(h(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return N.fromBytes(w("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return F.createCache(this,e),t||this.multiply(eE),this}assertValidity(){q(this)}hasEvenY(){let{y:e}=this.toAffine();if(!n.isOdd)throw Error("Field doesn't support isOdd");return!n.isOdd(e)}equals(e){v(e);let{X:t,Y:r,Z:i}=this,{X:o,Y:f,Z:s}=e,a=n.eql(n.mul(t,s),n.mul(o,i)),l=n.eql(n.mul(r,s),n.mul(f,i));return a&&l}negate(){return new N(this.X,n.neg(this.Y),this.Z)}double(){let{a:e,b:t}=o,r=n.mul(t,eE),{X:i,Y:f,Z:s}=this,a=n.ZERO,l=n.ZERO,u=n.ZERO,d=n.mul(i,i),c=n.mul(f,f),h=n.mul(s,s),m=n.mul(i,f);return m=n.add(m,m),u=n.mul(i,s),u=n.add(u,u),a=n.mul(e,u),l=n.mul(r,h),l=n.add(a,l),a=n.sub(c,l),l=n.add(c,l),l=n.mul(a,l),a=n.mul(m,a),u=n.mul(r,u),h=n.mul(e,h),m=n.sub(d,h),m=n.mul(e,m),m=n.add(m,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,h),d=n.mul(d,m),l=n.add(l,d),h=n.mul(f,s),h=n.add(h,h),d=n.mul(h,m),a=n.sub(a,d),u=n.mul(h,c),u=n.add(u,u),new N(a,l,u=n.add(u,u))}add(e){v(e);let{X:t,Y:r,Z:i}=this,{X:f,Y:s,Z:a}=e,l=n.ZERO,u=n.ZERO,d=n.ZERO,c=o.a,h=n.mul(o.b,eE),m=n.mul(t,f),y=n.mul(r,s),g=n.mul(i,a),p=n.add(t,r),b=n.add(f,s);p=n.mul(p,b),b=n.add(m,y),p=n.sub(p,b),b=n.add(t,i);let E=n.add(f,a);return b=n.mul(b,E),E=n.add(m,g),b=n.sub(b,E),E=n.add(r,i),l=n.add(s,a),E=n.mul(E,l),l=n.add(y,g),E=n.sub(E,l),d=n.mul(c,b),l=n.mul(h,g),d=n.add(l,d),l=n.sub(y,d),d=n.add(y,d),u=n.mul(l,d),y=n.add(m,m),y=n.add(y,m),g=n.mul(c,g),b=n.mul(h,b),y=n.add(y,g),g=n.sub(m,g),g=n.mul(c,g),b=n.add(b,g),m=n.mul(y,b),u=n.add(u,m),m=n.mul(E,b),l=n.mul(p,l),l=n.sub(l,m),m=n.mul(p,y),d=n.mul(E,d),new N(l,u,d=n.add(d,m))}subtract(e){return this.add(e.negate())}is0(){return this.equals(N.ZERO)}multiply(e){let r,n,{endo:o}=t;if(!i.isValidNot0(e))throw Error("invalid scalar: out of range");let f=e=>F.cached(this,e,e=>er(N,e));if(o){let{k1neg:t,k1:i,k2neg:s,k2:a}=I(e),{p:l,f:u}=f(i),{p:d,f:c}=f(a);n=u.add(c),r=T(o.beta,l,d,t,s)}else{let{p:t,f:i}=f(e);r=t,n=i}return er(N,[r,n])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!i.isValid(e))throw Error("invalid scalar: out of range");if(e===eg||this.is0())return N.ZERO;if(e===ep)return this;if(F.hasCache(this))return this.multiply(e);if(!r)return F.unsafe(this,e);{let{k1neg:t,k1:n,k2neg:i,k2:o}=I(e),{p1:f,p2:s}=function(e,t,r,n){let i=t,o=e.ZERO,f=e.ZERO;for(;r>Q||n>Q;)r&ee&&(o=o.add(i)),n&ee&&(f=f.add(i)),i=i.double(),r>>=ee,n>>=ee;return{p1:o,p2:f}}(N,this,n,o);return T(r.beta,f,s,t,i)}}multiplyAndAddUnsafe(e,t,r){let n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return A(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return f===ep||(e?e(N,this):F.unsafe(this,s).is0())}clearCofactor(){let{clearCofactor:e}=t;return f===ep?this:e?e(N,this):this.multiplyUnsafe(f)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}toBytes(e=!0){return c(e,"isCompressed"),this.assertValidity(),m(N,this,e)}toHex(e=!0){return(0,a.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return er(N,e)}static msm(e,t){return function(e,t,r,n){if(!Array.isArray(r))throw Error("array expected");r.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)});if(!Array.isArray(n))throw Error("array of scalars expected");n.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)});let i=r.length,o=n.length;if(i!==o)throw Error("arrays of points and scalars must have equal length");let f=e.ZERO,s=x(BigInt(i)),a=1;s>12?a=s-3:s>4?a=s-2:s>0&&(a=2);let l=O(a),u=Array(Number(l)+1).fill(f),d=Math.floor((t.BITS-1)/a)*a,c=f;for(let e=d;e>=0;e-=a){u.fill(f);for(let t=0;t<o;t++){let i=Number(n[t]>>BigInt(e)&l);u[i]=u[i].add(r[t])}let t=f;for(let e=u.length-1,r=f;e>0;e--)r=r.add(u[e]),t=t.add(r);if(c=c.add(t),0!==e)for(let e=0;e<a;e++)c=c.double()}return c}(N,i,e,t)}static fromPrivateKey(e){return N.BASE.multiply(eB(i,e))}}N.BASE=new N(o.Gx,o.Gy,n.ONE),N.ZERO=new N(n.ZERO,n.ONE,n.ZERO),N.Fp=n,N.Fn=i;let U=i.BITS,F=new eu(N,t.endo?Math.ceil(U/2):U);return N.BASE.precompute(8),N}(r,n),i,o);return t=f.Point,Object.assign({},f,{ProjectivePoint:t,CURVE:Object.assign({},e,z(t.Fn.ORDER,t.Fn.BITS))})})({...o,hash:e}))(f),create:t}),eP={};function eC(e,...t){let r=eP[e];if(void 0===r){let t=(0,s.sha256)((0,a.utf8ToBytes)(e));r=(0,a.concatBytes)(t,t),eP[e]=r}return(0,s.sha256)((0,a.concatBytes)(r,...t))}let eD=e=>e.toBytes(!0).slice(1),eK=eV.Point;function ej(e){let{Fn:t,BASE:r}=eK,n=eB(t,e),i=r.multiply(n);return{scalar:i.y%eF===eN?n:t.neg(n),bytes:eD(i)}}function e_(e){if(!eZ.isValidNot0(e))throw Error("invalid x: Fail if x â‰¥ p");let t=eZ.create(e*e),r=eZ.create(t*e+BigInt(7)),n=eZ.sqrt(r);n%eF!==eN&&(n=eZ.neg(n));let i=eK.fromAffine({x:e,y:n});return i.assertValidity(),i}function eH(...e){return eK.Fn.create(g(eC("BIP0340/challenge",...e)))}function ek(e){return ej(e).bytes}function eL(e,t,r){let{Fn:n,BASE:i}=eK,o=w("signature",e,64),f=w("message",t),s=w("publicKey",r,32);try{let e=e_(g(s)),t=g(o.subarray(0,32));if(!v(t,eU,eq.p))return!1;let r=g(o.subarray(32,64));if(!v(r,eU,eq.n))return!1;let a=eH(n.toBytes(t),eD(e),f),l=i.multiplyUnsafe(r).add(e.multiplyUnsafe(n.neg(a))),{x:u,y:d}=l.toAffine();if(l.is0()||d%eF!==eN||u!==t)return!1;return!0}catch(e){return!1}}let e$=(r=48,n=(e=(0,a.randomBytes)(r))=>J(e,eq.n),eV.utils.randomSecretKey,{keygen:function(e){let t=n(e);return{secretKey:t,publicKey:ek(t)}},getPublicKey:ek,sign:function(e,t,r=(0,a.randomBytes)(32)){let{Fn:n}=eK,i=w("message",e),{bytes:o,scalar:f}=ej(t),s=w("auxRand",r,32),l=n.toBytes(f^g(eC("BIP0340/aux",s))),{bytes:u,scalar:d}=ej(eC("BIP0340/nonce",l,o,i)),c=eH(u,o,i),h=new Uint8Array(64);if(h.set(u,0),h.set(n.toBytes(n.create(d+c*f)),32),!eL(h,i,o))throw Error("sign: Invalid signature produced");return h},verify:eL,Point:eK,utils:{randomSecretKey:n,randomPrivateKey:n,taggedHash:eC,lift_x:e_,pointToBytes:eD,numberToBytesBE:b,bytesToNumberBE:g,mod:C},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:r}}),eM=(i=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e))).map(e=>Array.from(e).reverse()),(e,t)=>{let[r,n,o,f]=i.map(t=>t.reduce((t,r)=>eZ.add(eZ.mul(t,e),r))),[s,a]=M(eZ,[n,f],!0);return e=eZ.mul(r,s),t=eZ.mul(t,eZ.mul(o,a)),{x:e,y:t}}),eY=function(e,t){$(e);let{A:r,B:n,Z:i}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(i))throw Error("mapToCurveSimpleSWU: invalid opts");let o=function(e,t){let r=e.ORDER,n=eg;for(let e=r-ep;e%eb===eg;e/=eb)n+=ep;let i=n,o=eb<<i-ep-ep,f=o*eb,s=(r-ep)/f,a=(s-ep)/eb,l=f-ep,u=e.pow(t,s),d=e.pow(t,(s+ep)/eb),c=(t,r)=>{let n=u,f=e.pow(r,l),s=e.sqr(f);s=e.mul(s,r);let c=e.mul(t,s);c=e.pow(c,a),c=e.mul(c,f),f=e.mul(c,r),s=e.mul(c,t);let h=e.mul(s,f);c=e.pow(h,o);let m=e.eql(c,e.ONE);f=e.mul(s,d),c=e.mul(h,n),s=e.cmov(f,s,m),h=e.cmov(c,h,m);for(let t=i;t>ep;t--){let r=t-eb;r=eb<<r-ep;let i=e.pow(h,r),o=e.eql(i,e.ONE);f=e.mul(s,n),n=e.mul(n,n),i=e.mul(h,n),s=e.cmov(f,s,o),h=e.cmov(i,h,o)}return{isValid:m,value:s}};if(e.ORDER%ew===eE){let r=(e.ORDER-eE)/ew,n=e.sqrt(e.neg(t));c=(t,i)=>{let o=e.sqr(i),f=e.mul(t,i);o=e.mul(o,f);let s=e.pow(o,r);s=e.mul(s,f);let a=e.mul(s,n),l=e.mul(e.sqr(s),i),u=e.eql(l,t),d=e.cmov(a,s,u);return{isValid:u,value:d}}}return c}(e,i);if(!e.isOdd)throw Error("Field does not have .isOdd()");return t=>{let f,s,a,l,u,d,c,h;f=e.sqr(t),f=e.mul(f,i),s=e.sqr(f),s=e.add(s,f),a=e.add(s,e.ONE),a=e.mul(a,n),l=e.cmov(i,e.neg(s),!e.eql(s,e.ZERO)),l=e.mul(l,r),s=e.sqr(a),d=e.sqr(l),u=e.mul(d,r),s=e.add(s,u),s=e.mul(s,a),d=e.mul(d,l),u=e.mul(d,n),s=e.add(s,u),c=e.mul(f,a);let{isValid:m,value:y}=o(s,d);h=e.mul(f,t),h=e.mul(h,y),c=e.cmov(c,a,m),h=e.cmov(h,y,m);let g=e.isOdd(t)===e.isOdd(h);h=e.cmov(e.neg(h),h,g);let p=M(e,[l],!0)[0];return{x:c=e.mul(c,p),y:h}}}(eZ,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:eZ.create(BigInt("-11"))}),ez=function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");function n(r){return e.fromAffine(t(r))}function i(t){let r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){let o=eI(e,2,Object.assign({},r,t)),f=n(o[0]),s=n(o[1]);return i(f.add(s))},encodeToCurve(e,t){let o=r.encodeDST?{DST:r.encodeDST}:{};return i(n(eI(e,1,Object.assign({},r,o,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw Error("expected array of bigints");for(let t of e)if("bigint"!=typeof t)throw Error("expected array of bigints");return i(n(e))},hashToScalar:(t,n)=>eI(t,1,Object.assign({},r,{p:e.Fn.ORDER,m:1,DST:eA},n))[0][0]}}(eV.Point,e=>{let{x:t,y:r}=eY(eZ.create(e[0]));return eM(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:eZ.ORDER,m:1,k:128,expand:"xmd",hash:s.sha256}),eG=ez.hashToCurve,eX=ez.encodeToCurve;e.s(["encodeToCurve",0,eX,"hashToCurve",0,eG,"schnorr",0,e$,"secp256k1",0,eV,"secp256k1_hasher",0,ez],965592)}]);